<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Superpong I/O - Preview</title>
    <!-- "Eejietype" isn't standard, using "Rubik Mono One" for that bold, creative, blocky look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik+Mono+One&family=Outfit:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --color-bg: #000000;
            --font-display: 'Rubik Mono One', sans-serif;
            --font-body: 'Outfit', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--color-bg);
            color: #ffffff;
            font-family: var(--font-body);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            gap: 20px;
            /* Space between header and game */
        }

        /* Header / Score Section (Outside Court) */
        .header-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            z-index: 10;
        }

        h1 {
            font-family: var(--font-display);
            font-size: 2.5rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: -1px;
            color: #ffffff;
            /* White logo as requested */
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }

        .score-board {
            display: flex;
            align-items: center;
            gap: 40px;
            font-family: var(--font-display);
            font-size: 3rem;
            color: #fff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .vs-badge {
            font-size: 1rem;
            font-family: var(--font-body);
            opacity: 0.5;
            font-weight: 700;
            letter-spacing: 2px;
        }

        /* Game Container */
        .game-wrapper {
            position: relative;
            padding: 4px;
            /* Tight padding for border effect */
            border-radius: 16px;
            /* Subtle outer glow */
            box-shadow: 0 0 100px rgba(66, 133, 244, 0.15);
            background: #111;
            flex-shrink: 1;
            /* Allow it to shrink if needed */
            min-height: 0;
        }

        canvas {
            display: block;
            background: #000;
            border-radius: 12px;
            cursor: none;
            box-shadow: inset 0 0 80px rgba(0, 0, 0, 0.9);
            border: 1px solid #222;
            max-width: 100%;
            max-height: 100%;
        }

        /* Player List (Absolute to the side of the court) */
        .player-list {
            position: absolute;
            left: -240px;
            top: 50%;
            transform: translateY(-50%);
            /* Center vertically relative to court */
            width: 220px;
            text-align: right;
            font-family: var(--font-body);
        }

        .player-list h3 {
            margin: 0 0 15px 0;
            color: #888;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
            display: inline-block;
        }

        .player-item {
            font-size: 1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
            color: #ddd;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #34A853;
            box-shadow: 0 0 8px #34A853;
        }

        .controls-hint {
            margin-top: 10px;
            color: #444;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: var(--font-body);
        }
    </style>
</head>

<body>

    <!-- Header Outside Court -->
    <div class="header-section">
        <h1>I/O Superpong</h1>
        <div class="score-board">
            <span id="scoreHuman">0</span>
            <span class="vs-badge">VS</span>
            <span id="scoreAI">0</span>
        </div>
    </div>

    <div class="game-wrapper">
        <div class="player-list">
            <h3>Team Human Connection</h3>
            <div class="player-item">You <div class="status-dot"></div>
            </div>
            <div class="player-item" style="color:#666">Player 2 <div class="status-dot"
                    style="background:#444;box-shadow:none"></div>
            </div>
            <div class="player-item" style="color:#666">Player 3 <div class="status-dot"
                    style="background:#444;box-shadow:none"></div>
            </div>
        </div>

        <canvas id="gameCanvas"></canvas>
    </div>

    <div class="controls-hint">Mouse Control Active</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game Constants
        const PADDLE_WIDTH = 24;
        const PADDLE_HEIGHT = 120;
        const BALL_SIZE = 16;
        const BALL_SPEED_BASE = 8;

        // Trail Configuration
        const TRAIL_LENGTH = 12;
        const trail = [];

        // State
        let game = {
            width: 800,
            height: 600,
            humanY: 250,
            aiY: 250,
            ball: { x: 400, y: 300, vx: BALL_SPEED_BASE, vy: BALL_SPEED_BASE * 0.5 },
            score: { human: 0, ai: 0 }
        };

        function resize() {
            // Reserve space for header (approx 150px) + padding
            const HEADER_HEIGHT = 180;
            const MAX_WIDTH = 1200;

            // Calculate available space
            const availableHeight = window.innerHeight - HEADER_HEIGHT - 40; // 40px bottom margin
            const availableWidth = window.innerWidth - 300; // Side margins for player list

            // Aspect ratio roughly 4:3 or wider
            game.height = Math.min(availableHeight, 600); // Reduced from 800
            game.width = Math.min(availableWidth, 900);   // Reduced from 1200

            // Ensure minimums
            game.height = Math.max(game.height, 300);
            game.width = Math.max(game.width, 500);

            canvas.width = game.width;
            canvas.height = game.height;
        }
        window.addEventListener('resize', resize);
        resize();

        window.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            game.humanY = e.clientY - rect.top - PADDLE_HEIGHT / 2;
        });

        function update() {
            // Update Trail
            trail.push({ x: game.ball.x, y: game.ball.y });
            if (trail.length > TRAIL_LENGTH) trail.shift();

            // Move Ball
            game.ball.x += game.ball.vx;
            game.ball.y += game.ball.vy;

            // Bounce Top/Bottom
            if (game.ball.y <= 0 || game.ball.y + BALL_SIZE >= game.height) {
                game.ball.vy *= -1;
            }

            // Paddle Collision Logic
            // Human
            if (game.ball.x <= 40 + PADDLE_WIDTH &&
                game.ball.y + BALL_SIZE >= game.humanY &&
                game.ball.y <= game.humanY + PADDLE_HEIGHT &&
                game.ball.vx < 0) {
                game.ball.vx *= -1.05;
                const hitPos = (game.ball.y - game.humanY) / PADDLE_HEIGHT;
                game.ball.vy += (hitPos - 0.5) * 10; // English/Spin
            }

            // AI
            if (game.ball.x >= game.width - 40 - PADDLE_WIDTH - BALL_SIZE &&
                game.ball.y + BALL_SIZE >= game.aiY &&
                game.ball.y <= game.aiY + PADDLE_HEIGHT &&
                game.ball.vx > 0) {
                game.ball.vx *= -1.15; // Faster accumulation
                const hitPos = (game.ball.y - game.aiY) / PADDLE_HEIGHT;
                game.ball.vy += (hitPos - 0.5) * 12; // More aggressive spin return
            }

            // Score
            if (game.ball.x < -20) {
                game.score.ai++;
                resetBall(1);
            } else if (game.ball.x > game.width + 20) {
                game.score.human++;
                resetBall(-1);
            }

            // Super AI (Predictive Tracking)
            let targetY = game.ball.y - PADDLE_HEIGHT / 2;

            // Only move if ball is coming towards AI or it's just centering
            if (game.ball.vx > 0) {
                // Simple prediction could go here, but raw reflexes are often harder
                // Increase reflexes significantly
                game.aiY += (targetY - game.aiY) * 0.25; // "Super" reflex speed
            } else {
                // Slowly center when ball moves away
                game.aiY += ((game.height / 2 - PADDLE_HEIGHT / 2) - game.aiY) * 0.05;
            }

            // Clamp
            game.humanY = Math.max(0, Math.min(game.height - PADDLE_HEIGHT, game.humanY));
            game.aiY = Math.max(0, Math.min(game.height - PADDLE_HEIGHT, game.aiY));

            draw();
            requestAnimationFrame(update);
        }

        function resetBall(direction) {
            game.ball.x = game.width / 2;
            game.ball.y = game.height / 2;
            game.ball.vx = BALL_SPEED_BASE * direction;
            game.ball.vy = (Math.random() - 0.5) * 6;
            trail.length = 0; // Clear trail
            document.getElementById('scoreHuman').textContent = game.score.human;
            document.getElementById('scoreAI').textContent = game.score.ai;
        }

        function draw() {
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, game.width, game.height);

            // Net
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 2;
            ctx.setLineDash([20, 20]);
            ctx.beginPath();
            ctx.moveTo(game.width / 2, 0);
            ctx.lineTo(game.width / 2, game.height);
            ctx.stroke();

            // 1. Draw Ball Trail (Rainbow)
            if (trail.length > 1) {
                for (let i = 0; i < trail.length - 1; i++) {
                    const alpha = (i / trail.length) * 0.6;
                    ctx.beginPath();
                    ctx.moveTo(trail[i].x + BALL_SIZE / 2, trail[i].y + BALL_SIZE / 2);
                    ctx.lineTo(trail[i + 1].x + BALL_SIZE / 2, trail[i + 1].y + BALL_SIZE / 2);

                    // Rainbow Gradient along trail? Or just simple color mapping
                    // Let's make the trail change color based on position/index
                    const hue = (i * 20 + Date.now() / 10) % 360;
                    ctx.strokeStyle = `hsla(${hue}, 80%, 60%, ${alpha})`;
                    ctx.lineWidth = BALL_SIZE * alpha;
                    ctx.lineCap = 'round';
                    ctx.stroke();
                }
            }

            // 2. Draw Paddles (Requested Gradient: Green -> Blue -> Yellow -> Red)
            const gradient = ctx.createLinearGradient(0, 0, 0, game.height); // Vertical gradient matching screen height essentially, or paddle height? 
            // The user image showed a vertical bar. Let's make the gradient relative to the PADDLE height for maximum pop, 
            // OR global to the screen? Global looks cooler for "team human".
            // Let's do paddle-local for maximum visibility of all colors.

            function drawPaddle(x, y) {
                const grad = ctx.createLinearGradient(x, y, x, y + PADDLE_HEIGHT);
                grad.addColorStop(0, '#34A853'); // Green
                grad.addColorStop(0.3, '#4285F4'); // Blue
                grad.addColorStop(0.7, '#FBBC04'); // Yellow
                grad.addColorStop(1, '#EA4335');   // Red

                ctx.fillStyle = grad;

                // Add a glow
                ctx.shadowBlur = 15;
                ctx.shadowColor = '#4285F4';

                // Rounded rect
                ctx.beginPath();
                ctx.roundRect(x, y, PADDLE_WIDTH, PADDLE_HEIGHT, 8);
                ctx.fill();

                ctx.shadowBlur = 0;
            }

            drawPaddle(40, game.humanY);
            drawPaddle(game.width - 40 - PADDLE_WIDTH, game.aiY); // AI gets same cool paddle

            // 3. Draw Ball
            ctx.fillStyle = '#ffffff';
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#ffffff';
            ctx.beginPath();
            ctx.arc(game.ball.x + BALL_SIZE / 2, game.ball.y + BALL_SIZE / 2, BALL_SIZE / 2, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        update();
    </script>
</body>

</html>